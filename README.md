# AY-Trade Arbitrage Scanner â€” README

Ð¡ÐµÑ€Ð²Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° ÑÐ¿Ñ€ÐµÐ´Ð¾Ð² Ð¼ÐµÐ¶Ð´Ñƒ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ð¼Ð¸ Ð±ÐµÑÑÑ€Ð¾Ñ‡Ð½Ñ‹Ð¼Ð¸ Ñ„ÑŒÑŽÑ‡ÐµÑ€ÑÐ½Ñ‹Ð¼Ð¸ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°Ð¼Ð¸ Ð½Ð° Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ð±Ð¸Ñ€Ð¶Ð°Ñ… (perps). 
ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¸Ð´ÐµÑ â€” **Ñ€ÐµÐ°Ð»-Ñ‚Ð°Ð¹Ð¼ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð±Ð¸Ð´/Ð°ÑÐº**, **Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð²**, Ñ€Ð°ÑÑ‡ÐµÑ‚ **Ð²Ñ…Ð¾Ð´Ð°/Ð²Ñ‹Ñ…Ð¾Ð´Ð°** Ð¸ Ð²Ñ‹Ð´Ð°Ñ‡Ð° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ñ‡ÐµÑ€ÐµÐ· **HTTP API** Ð¸ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) **WebSocket**.

---

## ðŸ“¦ Ð¡Ð¾ÑÑ‚Ð°Ð² Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ

```
arbitrage-scanner/
â”œâ”€ backend/
â”‚  â””â”€ src/
â”‚     â”œâ”€ arbitrage_scanner/
â”‚     â”‚  â”œâ”€ app.py                 # FastAPI Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ (REST + WS)
â”‚     â”‚  â”œâ”€ discovery.py           # ÐŸÐ¾Ð¸ÑÐº/ÐºÑÑˆ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð², Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð² Ð¸ Ð¼Ð°Ð¿Ð¿Ð¸Ð½Ð³ Ð¿Ð¾ Ð±Ð¸Ñ€Ð¶Ð°Ð¼
â”‚     â”‚  â”œâ”€ exchanges/
â”‚     â”‚  â”‚  â”œâ”€ mexc_perp.py        # ÐÐ´Ð°Ð¿Ñ‚ÐµÑ€ MEXC Perpetual
â”‚     â”‚  â”‚  â”œâ”€ gate_perp.py        # ÐÐ´Ð°Ð¿Ñ‚ÐµÑ€ Gate Perpetual
â”‚     â”‚  â”‚  â””â”€ bingx_perp.py       # ÐÐ´Ð°Ð¿Ñ‚ÐµÑ€ BingX Perpetual
â”‚     â”‚  â””â”€ ...
â”‚     â””â”€ ...
â”œâ”€ frontend/                        # Ð’Ð°Ñˆ Next.js Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ (Ð¿Ð°Ñ€Ð½Ñ‹Ðµ Ð²Ð¸Ð´Ñ‹/ÑÐ¿Ñ€ÐµÐ´Ñ‹)
â””â”€ README.md                        # Ð­Ñ‚Ð¾Ñ‚ Ñ„Ð°Ð¹Ð»
```

> Ð•ÑÐ»Ð¸ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñƒ Ð²Ð°Ñ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð°ÐµÑ‚ÑÑ â€” Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð¸Ñ€ÑƒÐ¹Ñ‚ÐµÑÑŒ Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð°Ð¼ Ð¼Ð¾Ð´ÑƒÐ»ÐµÐ¹. Ð’ ÑÑ‚Ð¾Ð¼ README Ð´Ð°Ð½Ñ‹ **Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹** (ÑÐ¼. Ð½Ð¸Ð¶Ðµ) Ð¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ, ÐºÐ°Ðº Ð¸Ñ… Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ.

---

## âš™ï¸ Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ ÑÐµÑ€Ð²Ð¸Ñ

1. **ÐŸÑ€Ð¸ ÑÑ‚Ð°Ñ€Ñ‚Ðµ**:
   - ÐŸÐ¾Ð´Ñ‚ÑÐ³Ð¸Ð²Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº Ð±ÐµÑÑÑ€Ð¾Ñ‡Ð½Ñ‹Ñ… Ñ„ÑŒÑŽÑ‡ÐµÑ€ÑÐ½Ñ‹Ñ… ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð² Ñ Ð±Ð¸Ñ€Ð¶: **MEXC**, **BingX**, **Gate** (REST).
   - ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·ÑƒÐµÑ‚ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ñ Ð² ÑƒÐ½Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð²Ð¸Ð´: `BASEQUOTE` (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `BTCUSDT`) Ð¸ `BASE_QUOTE`/`BASE-QUOTE` Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸.
   - Ð¡Ñ‚Ñ€Ð¾Ð¸Ñ‚ **ÐºÑ€Ð¾ÑÑ-Ð±Ð¸Ñ€Ð¶ÐµÐ²Ð¾Ð¹ Ð¼Ð°Ð¿Ð¿Ð¸Ð½Ð³ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ñ… Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²**.

2. **Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹**:
   - ÐŸÐ¾Ð´Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚ÑÑ Ð½Ð° **WS Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ Ð±Ð¸Ð´/Ð°ÑÐº** Ð¿Ð¾ *Ð²ÑÐµÐ¼* ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°Ð¼ Ð½Ð° ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð±Ð¸Ñ€Ð¶Ðµ.
   - ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ **ÑÑ‚Ð°Ð²ÐºÐ¸ Ñ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ** Ð¸ **Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð½Ñ‹Ðµ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ñ‹**, ÐºÐ¾Ð³Ð´Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ (Ñ‡ÐµÑ€ÐµÐ· REST/WS).
   - Ð¡Ñ‡Ð¸Ñ‚Ð°ÐµÑ‚ ÐºÐ°Ð½Ð´Ð¸Ð´Ð°Ñ‚Ñ‹ Ð½Ð° Ð°Ñ€Ð±Ð¸Ñ‚Ñ€Ð°Ð¶ (**Ð²Ñ…Ð¾Ð´**/**Ð²Ñ‹Ñ…Ð¾Ð´**) Ð¸ Ð¾Ñ‚Ð´Ð°Ñ‘Ñ‚ Ð¸Ñ… Ð½Ð°Ñ€ÑƒÐ¶Ñƒ.

3. **Ð’Ñ‹Ð´Ð°Ñ‡Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…**:
   - **HTTP API** (FastAPI) Ñ `GET /stats`, `GET /pairs`, `GET /health` Ð¸ Ð´Ñ€.
   - **WebSocket** ÐºÐ°Ð½Ð°Ð» Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¹ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾): Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð²Ñ‹Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¿Ñ€ÐµÐ´Ð¾Ð²/ÐºÐ²Ð¾Ñ‚.

---

## ðŸ”Œ ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ðµ Ð±Ð¸Ñ€Ð¶Ð¸ Ð¸ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸

- **MEXC (Perpetual)**  
  ÐšÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ñ‹: `https://contract.mexc.com/api/v1/contract/detail`  
  ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð²: `BTC_USDT`, `ETH_USDT`, ...

- **BingX (Perpetual)**  
  ÐšÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ñ‹: `https://open-api.bingx.com/openApi/swap/v2/quote/contracts`  
  ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð²: `BTC-USDT` â†’ Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·ÑƒÐµÐ¼ Ð² `BTCUSDT`.

- **Gate (Perpetual)**  
  ÐšÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ñ‹: Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ REST `/futures/usdt/contracts` (Ð¸Ð»Ð¸ Ð°Ð½Ð°Ð»Ð¾Ð³ Ð´Ð»Ñ perp), Ñ‚Ð¸ÐºÐµÑ€Ñ‹ Ð²Ð¸Ð´Ð° `BTC_USDT` â†’ Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·ÑƒÐµÐ¼.

ÐÐ´Ð°Ð¿Ñ‚ÐµÑ€Ñ‹ (`mexc_perp.py`, `bingx_perp.py`, `gate_perp.py`) ÑƒÐ¶Ðµ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÑŽÑ‚:
- Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²,
- Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹,
- WSâ€‘Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸ Ð½Ð° best bid/ask,
- (ÐºÐ¾Ð³Ð´Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾) ÑÑ‚Ð°Ð²ÐºÐ¸ Ñ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.

---

## ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚ (Backend)

### 1) Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸

Python 3.10+ (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ð½Ð¾ 3.11/3.12).

```bash
cd backend/src
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -U pip wheel
pip install -r requirements.txt  # ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ; Ð¸Ð½Ð°Ñ‡Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ fastapi uvicorn websockets httpx pydantic
```

ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð½Ð°Ð±Ð¾Ñ€:
```bash
pip install fastapi uvicorn[standard] httpx websockets pydantic==2.*
```

### 2) ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ `.env` (Ð¸Ð»Ð¸ Ð·Ð°Ð´Ð°Ð¹Ñ‚Ðµ Ð² systemd):
```
HOST=127.0.0.1
PORT=8010
ROOT_PATH=/api

# Ð¢Ð¾Ð³Ð³Ð»Ñ‹ Ð±Ð¸Ñ€Ð¶ (1/0)
EXCH_MEXC=1
EXCH_BINGX=1
EXCH_GATE=1

# Ð¢Ð°Ð¹Ð¼Ð¸Ð½Ð³Ð¸ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
DISCOVERY_TTL_SEC=1800        # ÐºÐ°Ðº Ñ‡Ð°ÑÑ‚Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÑ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²
WS_RECONNECT_DELAY_SEC=3
BOOTSTRAP_DELAY_SEC=1.0
```

> APIâ€‘ÐºÐ»ÑŽÑ‡Ð¸ **Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ÑÑ** Ð´Ð»Ñ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… ÐºÐ¾Ñ‚Ð¸Ñ€Ð¾Ð²Ð¾Ðº/ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð². Ð”Ð»Ñ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ (Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ) Ð¿Ð¾Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ÑÑ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÐºÐ»ÑŽÑ‡Ð¸ â€” Ð²Ð½Ðµ Ñ€Ð°Ð¼Ð¾Ðº ÑÑ‚Ð¾Ð³Ð¾ README.

### 3) Ð—Ð°Ð¿ÑƒÑÐº Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾

```bash
uvicorn arbitrage_scanner.app:app \
  --host ${HOST:-127.0.0.1} --port ${PORT:-8010} \
  --root-path ${ROOT_PATH:-/api} --proxy-headers
```

ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ¸:
```bash
curl -s http://127.0.0.1:8010/health
curl -s http://127.0.0.1:8010/stats | jq
curl -s http://127.0.0.1:8010/pairs | jq | head
```

### 4) systemd ÑŽÐ½Ð¸Ñ‚ (Ð¿Ñ€Ð¾Ð´)

`/etc/systemd/system/aytrade-api.service`

```ini
[Unit]
Description=AYTRADE FastAPI (Uvicorn)
After=network.target

[Service]
User=aytrade
WorkingDirectory=/opt/aytrade/app/backend/src
Environment="HOST=127.0.0.1"
Environment="PORT=8010"
Environment="ROOT_PATH=/api"
Environment="EXCH_MEXC=1"
Environment="EXCH_BINGX=1"
Environment="EXCH_GATE=1"
ExecStart=/opt/aytrade/venv/bin/uvicorn arbitrage_scanner.app:app \
  --host ${HOST} --port ${PORT} \
  --root-path ${ROOT_PATH} \
  --proxy-headers
Restart=always
RestartSec=3

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl daemon-reload
sudo systemctl enable --now aytrade-api.service
sudo systemctl status aytrade-api.service
```

### 5) Nginx (reverse proxy)

Ð¡Ð°Ð¹Ñ‚ `aytrade.space` (Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´) Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð¿Ñ€Ð¾ÐºÑÐ¸Ñ€ÑƒÐµÑ‚ `/api` Ð½Ð° Ð±ÑÐºÐµÐ½Ð´:

```nginx
location /api/ {
  proxy_pass         http://127.0.0.1:8010/api/;
  proxy_http_version 1.1;
  proxy_set_header   Upgrade $http_upgrade;
  proxy_set_header   Connection "upgrade";
  proxy_set_header   Host $host;
  proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header   X-Forwarded-Proto $scheme;
}
```

ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°:
```bash
curl -s http://aytrade.space/api/health
curl -s http://aytrade.space/api/stats | jq | head
```

---

## ðŸ§  ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð²

Ð¦ÐµÐ»ÑŒ â€” ÑÐ²ÐµÑÑ‚Ð¸ Ð²ÑÐµ ÑÐ¸Ð¼Ð²Ð¾Ð»Ñ‹ Ðº ÐºÐ°Ð½Ð¾Ð½Ð¸Ñ‡ÐµÑÐºÐ¾Ð¼Ñƒ `BASEQUOTE`:

- `BTC_USDT` â†’ `BTCUSDT`
- `BTC-USDT` â†’ `BTCUSDT`
- `ETH_USD`  â†’ `ETHUSD`

ÐŸÑ€Ð°Ð²Ð¸Ð»Ð° Ð² `discovery.py`:
- ÑƒÐ´Ð°Ð»ÑÐµÐ¼ Ñ€Ð°Ð·Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ»Ð¸ (`_`, `-`),
- Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÐ¼ Ð·Ð°Ð³Ð»Ð°Ð²Ð½Ñ‹Ðµ,
- Ð´Ð»Ñ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð±Ð¸Ñ€Ð¶ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð» Ð¸ Ð¼Ð°Ð¿Ð¿Ð¸Ð½Ð³ `canonical â†’ {per_exchange_symbol}`.

ÐŸÑ€Ð¸Ð¼ÐµÑ€ JSON Ð¿Ð°Ñ€Ñ‹ (ÑƒÐ¿Ñ€Ð¾Ñ‰Ñ‘Ð½Ð½Ð¾):
```json
{
  "canonical": "BTCUSDT",
  "exchanges": {
    "MEXC": "BTC_USDT",
    "BINGX": "BTC-USDT",
    "GATE": "BTC_USDT"
  }
}
```

---

## ðŸ“¡ ÐŸÐ¾Ñ‚Ð¾ÐºÐ¸ Ð¸ ÐºÐ¾Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ¸

ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð°Ð´Ð°Ð¿Ñ‚ÐµÑ€:
- Ð”ÐµÐ»Ð°ÐµÑ‚ RESTâ€‘Ð´Ð¸ÑÐºÐ°Ð²ÐµÑ€Ð¸ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð².
- ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ WSâ€‘Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸ Ð½Ð° Ð»ÑƒÑ‡ÑˆÐ¸Ðµ Ñ†ÐµÐ½Ñ‹ (best bid/ask) Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ð¼ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°Ð¼.
- ÐŸÑ€Ð¸ Ñ€ÐµÐºÐ¾Ð½Ð½ÐµÐºÑ‚Ðµ â€” **Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿ÐµÑ€ÐµÐ¿Ð¾Ð´Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚ÑÑ**.
- ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð°Ð¿Ð´ÐµÐ¹Ñ‚Ñ‹ Ð² Ð¾Ð±Ñ‰Ð¸Ð¹ Ð°Ð³Ñ€ÐµÐ³Ð°Ñ‚Ð¾Ñ€, Ð³Ð´Ðµ ÑƒÐ¶Ðµ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ ÑÐ¿Ñ€ÐµÐ´ Ð¼ÐµÐ¶Ð´Ñƒ Ð±Ð¸Ñ€Ð¶Ð°Ð¼Ð¸ Ð´Ð»Ñ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ñ… `canonical`.

---

## ðŸ“š HTTP API (Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ)

Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ `ROOT_PATH` (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ `/api`).

- `GET /health` â€” Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ.  
  ÐžÑ‚Ð²ÐµÑ‚: `{"status": "ok", "exchanges": {...}}`

- `GET /stats` â€” ÑÐ²Ð¾Ð´ÐºÐ° Ð¿Ð¾ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ°Ð¼/ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²/Ð°Ð¿Ñ‚Ð°Ð¹Ð¼Ñƒ.  
  ÐŸÐ¾Ð»ÐµÐ·Ð½Ð¾ Ð´Ð»Ñ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ¸.

- `GET /pairs` â€” ÑÐ¿Ð¸ÑÐ¾Ðº Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð°Ñ€ Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ Ð½Ð° Ð±Ð¸Ñ€Ð¶Ð°Ñ….  
  ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹:  
  - `q` â€” Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð¿Ð¾Ð´ÑÑ‚Ñ€Ð¾ÐºÐµ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `BTC`),
  - `ex` â€” Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð±Ð¸Ñ€Ð¶Ðµ (`MEXC|BINGX|GATE`),
  - `limit` â€” Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»-Ð²Ð¾.

- `GET /spreads` â€” Ñ‚ÐµÐºÑƒÑ‰Ð¸Ðµ ÐºÑ€Ð¾ÑÑâ€‘Ð±Ð¸Ñ€Ð¶ÐµÐ²Ñ‹Ðµ ÑÐ¿Ñ€ÐµÐ´Ñ‹ Ð¿Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ð¼ Ð¿Ð°Ñ€Ð°Ð¼.  
  ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹:  
  - `min_abs` â€” Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ñ‹Ð¹ ÑÐ¿Ñ€ÐµÐ´ Ð² %,
  - `top` â€” Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ñ‚Ð¾Ð¿-N Ð¿Ð¾ Ð¼Ð¾Ð´ÑƒÐ»ÑŽ ÑÐ¿Ñ€ÐµÐ´Ð°,
  - `symbols` â€” ÑÐ¿Ð¸ÑÐ¾Ðº Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑƒÑŽÑ‰Ð¸Ñ… `canonical` Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ.

*(Ð•ÑÐ»Ð¸ Ñƒ Ð²Ð°Ñ Ð½ÐµÑ‚ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð° `GET /spreads`, Ð²ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ ÐµÐ³Ð¾ Ð² `app.py` â€” ÐºÐ°Ñ€ÐºÐ°Ñ ÑƒÐ¶Ðµ Ð¿Ñ€ÐµÐ´ÑƒÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½.)*

---

## ðŸ§ª Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ (Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹)

MEXC:
```bash
curl -sS 'https://contract.mexc.com/api/v1/contract/detail' | jq '.data | length'
curl -sS 'https://contract.mexc.com/api/v1/contract/detail' | jq -r '.data[0:10][]?.symbol'
```

BingX:
```bash
curl -sS 'https://open-api.bingx.com/openApi/swap/v2/quote/contracts' | jq -r '.data[0:10][]?.symbol'
curl -sS 'https://open-api.bingx.com/openApi/swap/v2/quote/contracts' | jq -r '.data[].symbol | gsub("-"; "")' | head
```

ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð±ÑÐºÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð°Ð³Ñ€ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ñ‹/ÑÑ‚Ð°Ñ‚ÑƒÑ:
```bash
curl -s http://127.0.0.1:8010/health
curl -s http://127.0.0.1:8010/pairs  | jq | head
curl -s http://127.0.0.1:8010/stats  | jq
```

---

## ðŸ§© Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´Ð¾Ð¼

Ð¤Ñ€Ð¾Ð½Ñ‚ (Next.js) Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ:
- Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ `fetch` Ðº `/api/spreads` Ð¸ `/api/pairs`,
- Ð»Ð¸Ð±Ð¾ Ñ‡ÐµÑ€ÐµÐ· **WS** (ÐµÑÐ»Ð¸ Ð²ÐºÐ»ÑŽÑ‡Ñ‘Ð½ Ð² `app.py`):  
  `wss://aytrade.space/api/ws` (Ð¿Ñ€Ð¸Ð¼ÐµÑ€; Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑÐ²Ð¾Ð¹ Ñ€Ð¾ÑƒÑ‚).

> Ð’Ð°Ð¶Ð½Ð¾: **Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° < 1 ÑÐµÐº** Ð´Ð¾ÑÑ‚Ð¸Ð³Ð°ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾Ð¹ WSâ€‘Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐµ Ð½Ð° Ð±ÑÐºÐµ Ð¸ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ Ð½Ð° Ñ„Ñ€Ð¾Ð½Ñ‚Ðµ. Ð˜Ð·Ð±ÐµÐ³Ð°Ð¹Ñ‚Ðµ Ñ‚ÑÐ¶Ñ‘Ð»Ñ‹Ñ… Ð°Ð³Ñ€ÐµÐ³Ð°Ñ‚Ð¾Ð² Ð½Ð° ÐºÐ»Ð¸ÐµÐ½Ñ‚Ðµ â€” ÑÑ‡Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ ÑÐ¿Ñ€ÐµÐ´Ñ‹ Ð½Ð° Ð±ÑÐºÐµ Ð¸ Ð¾Ñ‚Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑƒÐ¶Ðµ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ.

---

## ðŸ§± Ð§Ð°ÑÑ‚Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹

1. **ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…/Ð¼Ð°Ð»Ð¾ Ð¿Ð°Ñ€**:  
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾ `EXCH_*=1` Ð¸ Ð±Ð¸Ñ€Ð¶Ð¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ñ‹.
   - Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°ÐµÑ‚ Ñ‚Ð¸Ð¿ Ñ€Ñ‹Ð½ÐºÐ° (perpetual/USDTâ€‘margined).

2. **WS Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð·Ð° Nginx**:  
   - ÐÐµ Ð·Ð°Ð±Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ `proxy_set_header Upgrade` Ð¸ `Connection "upgrade"` Ð² Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸ `/api/`.

3. **Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ°/Ð»Ð°Ð³**:  
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ CPU/ÑÐµÑ‚ÑŒ VPS, Ð»Ð¸Ð¼Ð¸Ñ‚Ñ‹ `ulimit`, Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ð»Ð¸ÑˆÐ½Ð¸Ðµ Ð»Ð¾Ð³Ð¸.
   - Ð£Ð¼ÐµÐ½ÑŒÑˆÐ¸Ñ‚Ðµ Ð¾Ð±ÑŠÑ‘Ð¼ ÑÐµÑ€Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ (Ð¾Ñ‚Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½ÑƒÐ¶Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ).

4. **Ð Ð°Ð·Ð½Ñ‹Ðµ Ð¸Ð¼ÐµÐ½Ð° Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð²**:  
   - Ð¡Ð¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ Ð¼Ð°Ð¿Ð¿Ð¸Ð½Ð³ `canonical â†’ per_exchange_symbol` Ð¸Ð· `discovery.py`.
   - ÐŸÑ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐ¹Ñ‚Ðµ Ñ…Ð°Ñ€Ð´ÐºÐ¾Ð´â€‘Ð°Ð»Ð¸Ð°ÑÑ‹ (Ñ€ÐµÐ´ÐºÐ¾ Ð½ÑƒÐ¶Ð½Ð¾).

---

## ðŸ”„ ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ/Ð”ÐµÐ¿Ð»Ð¾Ð¹

```bash
cd /opt/aytrade/app
git fetch origin
git checkout main
git reset --hard origin/main

# ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÐºÑƒ Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÑÑ… Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
source /opt/aytrade/venv/bin/activate
pip install -r backend/src/requirements.txt  # ÐµÑÐ»Ð¸ Ñ„Ð°Ð¹Ð» Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº
sudo systemctl restart aytrade-api.service
journalctl -u aytrade-api.service -n 200 -f
```

---

## ðŸ“ Ð“Ð¾Ñ‚Ð¾Ð²Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð´Ð»Ñ Ð·Ð°Ð¼ÐµÐ½Ñ‹

Ð•ÑÐ»Ð¸ Ð²Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð»Ð¸ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹, Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚Ðµ Ð¸Ñ… Ñ‚Ð°Ðº:

- `backend/src/arbitrage_scanner/app.py`
- `backend/src/arbitrage_scanner/discovery.py`
- `backend/src/arbitrage_scanner/exchanges/mexc_perp.py`
- `backend/src/arbitrage_scanner/exchanges/gate_perp.py`
- `backend/src/arbitrage_scanner/exchanges/bingx_perp.py`

ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð¼ÐµÐ½Ñ‹ â€” Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²Ð¸ÑÐ° (ÑÐ¼. Ð²Ñ‹ÑˆÐµ).

---

## ðŸ“ Ð›Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ

MIT â€” Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾, Ð½Ð¾ Ð±ÐµÐ· Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ð¹. ÐÐ²Ñ‚Ð¾Ñ€ Ð¸ ÐºÐ¾Ð½Ñ‚Ñ€Ð¸Ð±ÑŒÑŽÑ‚Ð¾Ñ€Ñ‹ Ð½Ðµ Ð½ÐµÑÑƒÑ‚ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð·Ð° Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ ÑƒÐ±Ñ‹Ñ‚ÐºÐ¸ Ð¾Ñ‚ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ð¸. ÐšÑ€Ð¸Ð¿Ñ‚Ð¾Ñ€Ñ‹Ð½ÐºÐ¸ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ñ€Ð¸ÑÐºÐ¾Ð²Ð°Ð½Ð½Ñ‹Ðµ; Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð½Ð° ÑÐ²Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ñ… Ð¸ Ñ€Ð¸ÑÐº.

---

## â“Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹

ÐŸÐ¸ÑˆÐ¸Ñ‚Ðµ Ð² Ñ‚Ñ€ÐµÐ´/Ñ‡Ð°Ñ‚ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð¸Ð»Ð¸ Ð¿Ð¾Ð´Ð½Ð¸Ð¼Ð°Ð¹Ñ‚Ðµ Issue Ð² GitHub Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸: `Artteem/arbitrage-scanner`.
